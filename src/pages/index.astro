---
import { type CollectionEntry, getCollection } from "astro:content";
import SocialList from "@/components/SocialList.astro";
import PostPreview from "@/components/blog/PostPreview.astro";
import Note from "@/components/note/Note.astro";
import { getAllPosts } from "@/data/post";
import PageLayout from "@/layouts/Base.astro";
import { collectionDateSort } from "@/utils/date";
import Avator from "@/components/Avator.astro";
import Experience from "@/components/Experience.astro";

// Posts
const MAX_POSTS = 10;
const allPosts = await getAllPosts();
const allPostsByDate = allPosts
	.sort(collectionDateSort)
	.slice(0, MAX_POSTS) as CollectionEntry<"post">[];

// Notes
const MAX_NOTES = 2;
const allNotes = await getCollection("note");
const latestNotes = allNotes.sort(collectionDateSort).slice(0, MAX_NOTES);
---

<PageLayout meta={{ title: "Maksymilan's" }}>
	<!-- Hero section -->
	<!-- Background blur -->
	<div class="absolute top-0 left-1/2 md:top-[-15%] -ml-[50vw] min-h-screen w-screen pointer-events-none blur-3xl opacity-50 overflow-x-hidden">
		<div class="absolute top-[10%] right-[-40%] w-[65%] h-full bg-gradient-to-b from-white-300 via-blue-300 to-white-300 rounded-full opacity-30 dark:opacity-10"></div>
		<div class="absolute top-[10%] left-[-40%] w-[65%] h-full bg-gradient-to-b from-white-300 via-blue-300 to-white-300 rounded-full opacity-30 dark:opacity-10"></div>
		<!-- <div class="absolute top-[-20%] left-[-50%] w-[85%] h-full bg-gradient-to-b from-black-300 via-orange-300 to-transparent rounded-full opacity-60 dark:opacity-10"></div> -->
		<!-- <div class="absolute top-[-20%] right-[-50%] w-[85%] h-full bg-gradient-to-b from-blue-300 via-indigo-300 to-transparent rounded-full opacity-60 dark:opacity-10"></div> -->
	</div>
	
	<!-- <section> -->
	<div class="flex justify-center py-16 transform -translate-y-20">
		<Avator src="/avatar.jpg" alt="avator" size="w-48" link="" />
	</div>
	<!-- </section> -->
	<section class="max-w-3xl mx-auto relative flex items-center justify-center -mt-24">
		<div class="w-full text-center relative">
			<!-- Language Toggle -->
			<div class="absolute right-0 top-0 md:-right-12 md:top-0 z-10">
				<button id="lang-toggle" class="px-3 py-1 text-sm font-semibold rounded-full bg-accent-one/10 hover:bg-accent-one/20 text-accent-two transition-colors border border-accent-two/20 backdrop-blur-sm">
					ä¸­ / En
				</button>
			</div>

			<!-- English Content -->
			<div id="content-en">
				<span class="title text-3xl bg-gradient-to-r from-accent-two/85 via-accent-one/85 to-accent-two/85 dark:from-accent-two dark:via-accent-one dark:to-accent-two bg-clip-text text-transparent">
					ğŸ‘‹ Hi, I'm Maksymilan!
				</span>
				<div class="flex justify-center mt-4 mb-4">
					<SocialList />
				</div>
				<div class="mt-4 mb-4 text-lg font-medium text-left space-y-4">
					<p>
						I'm a third-year undergraduate student at Zhejiang University (ZJU) with a passion for computer systems and artificial intelligence.
					</p>
					<p>
						ğŸ”¬ My primary research interests are in Machine Learning Systems (MLSys) and AI Infrastructure.
					</p>
					<p>
						ğŸ‘¨â€ğŸ’» I am currently diving deep into AI Infra and LLM training/inference frameworks. My primary programming languages are C++ and Python.
					</p>
					<p>
						ğŸ’¼ I'm currently interning at ByteDance (Volcengine), working on the Storage Infrastructure team, participating in the KV cache acceleration project for model inference (Elastic Instant Cache).
					</p>
					<p>
						ğŸ¤ If you are interested in my work or have a suitable opportunity, please feel free to connect with me via the links above. Let's build something amazing together!
					</p>
				</div>
				<div class="flex justify-center space-x-4 mt-4">
					<a href="/posts/" class="relative flex items-center justify-center h-8 px-4 rounded-lg shadow-lg hover:brightness-110 transition-all bg-gradient-to-r from-accent-one to-accent-two">
						<span class="text-bgColor font-semibold">
							Posts
						</span>
					</a>

					<a href="/notes/wake-up/" class="relative flex items-center justify-center h-8 px-4 rounded-lg shadow-lg bg-special-lighter hover:brightness-110 hover:bg-special-lightest">
						<span class="bg-clip-text text-transparent font-semibold bg-gradient-to-r from-accent-one to-accent-two">
							Notes
						</span>
					</a>
				</div>

				<div class="mt-12 text-left">
					<h2 class="text-2xl font-bold mb-6 flex items-center">
						<span class="bg-clip-text text-transparent bg-gradient-to-r from-accent-one to-accent-two">Experience</span>
						<span class="ml-2 text-2xl">ğŸ’¼</span>
					</h2>
					<div class="space-y-4">
						<Experience
							type="internship"
							logo="/images/bytedance.png"
							title="ByteDance (Volcengine)"
							role="Storage Infrastructure Intern"
							time="2025.10 - Present"
						/>
					</div>

					<h2 class="text-2xl font-bold mb-6 mt-12 flex items-center">
						<span class="bg-clip-text text-transparent bg-gradient-to-r from-accent-one to-accent-two">Education</span>
						<span class="ml-2 text-2xl">ğŸ“</span>
					</h2>
					<div class="space-y-4">
						<Experience
							type="education"
							logo="/images/zju.png"
							title="Zhejiang University"
							role="B.Eng. in Industrial Design"
							time="2023 - 2027 (Expected)"
						/>
					</div>
				</div>
			</div>

			<!-- Chinese Content -->
			<div id="content-zh" class="hidden">
				<span class="title text-3xl bg-gradient-to-r from-accent-two/85 via-accent-one/85 to-accent-two/85 dark:from-accent-two dark:via-accent-one dark:to-accent-two bg-clip-text text-transparent">
					ğŸ‘‹ å—¨ï¼Œæˆ‘æ˜¯ Maksymilanï¼
				</span>
				<div class="flex justify-center mt-4 mb-4">
					<SocialList />
				</div>
				<div class="mt-4 mb-4 text-lg font-medium text-left space-y-4">
					<p>
						æˆ‘æ˜¯æµ™æ±Ÿå¤§å­¦ï¼ˆZJUï¼‰çš„ä¸€åå¤§ä¸‰æœ¬ç§‘ç”Ÿï¼Œå¯¹è®¡ç®—æœºç³»ç»Ÿå’Œäººå·¥æ™ºèƒ½æ„Ÿå…´è¶£ã€‚
					</p>
					<p>
						ğŸ”¬ æˆ‘çš„ä¸»è¦å­¦ä¹ å’Œç ”ç©¶æ–¹å‘æ˜¯æœºå™¨å­¦ä¹ ç³»ç»Ÿï¼ˆMLSysï¼‰å’Œ AI Infraã€‚
					</p>
					<p>
						ğŸ‘¨â€ğŸ’» æˆ‘ç›®å‰æ­£åœ¨æ·±å…¥å¯¹Ai infraå’Œå¤§æ¨¡å‹è®­ç»ƒæ¨ç†æ¡†æ¶å­¦ä¹ ã€‚æˆ‘æœ€å¸¸ç”¨çš„çš„å·¥ä½œè¯­è¨€æ˜¯ C++ å’Œ Pythonã€‚
					</p>
					<p>
						ğŸ’¼ æˆ‘ç›®å‰åœ¨å­—èŠ‚è·³åŠ¨ï¼ˆç«å±±å¼•æ“ï¼‰å®ä¹ ï¼Œåœ¨å­˜å‚¨åŸºç¡€è®¾æ–½å›¢é˜Ÿå·¥ä½œï¼Œå‚ä¸åˆ°æ¨¡å‹æ¨ç†æ—¶çš„kv cacheåŠ é€Ÿé¡¹ç›®ï¼ˆElastic Instant Cacheï¼‰ã€‚
					</p>
					<p>
						ğŸ¤ å¦‚æœä½ å¯¹æˆ‘æ„Ÿå…´è¶£æˆ–æœ‰åˆé€‚çš„æœºä¼šï¼Œå¯ä»¥éšæ—¶é€šè¿‡ä¸Šæ–¹çš„é“¾æ¥ä¸æˆ‘è”ç³»ã€‚è®©æˆ‘ä»¬ä¸€èµ·åšä¸€äº›æœ‰æ„æ€çš„ä¸œè¥¿ï¼
					</p>
				</div>
				<div class="flex justify-center space-x-4 mt-4">
					<a href="/posts/" class="relative flex items-center justify-center h-8 px-4 rounded-lg shadow-lg hover:brightness-110 transition-all bg-gradient-to-r from-accent-one to-accent-two">
						<span class="text-bgColor font-semibold">
							å¾€æœŸåšå®¢
						</span>
					</a>

					<a href="/notes/wake-up/" class="relative flex items-center justify-center h-8 px-4 rounded-lg shadow-lg bg-special-lighter hover:brightness-110 hover:bg-special-lightest">
						<span class="bg-clip-text text-transparent font-semibold bg-gradient-to-r from-accent-one to-accent-two">
							ç¢ç¢å¿µ
						</span>
					</a>
				</div>

				<div class="mt-12 text-left">
					<h2 class="text-2xl font-bold mb-6 flex items-center">
						<span class="bg-clip-text text-transparent bg-gradient-to-r from-accent-one to-accent-two">å®ä¹ ç»å†</span>
						<span class="ml-2 text-2xl">ğŸ’¼</span>
					</h2>
					<div class="space-y-4">
						<Experience
							type="internship"
							logo="/images/bytedance.png"
							title="å­—èŠ‚è·³åŠ¨ (ç«å±±å¼•æ“)"
							role="å­˜å‚¨åŸºç¡€è®¾æ–½å®ä¹ ç”Ÿ"
							time="2025.10 - è‡³ä»Š"
						/>
					</div>

					<h2 class="text-2xl font-bold mb-6 mt-12 flex items-center">
						<span class="bg-clip-text text-transparent bg-gradient-to-r from-accent-one to-accent-two">æ•™è‚²ç»å†</span>
						<span class="ml-2 text-2xl">ğŸ“</span>
					</h2>
					<div class="space-y-4">
						<Experience
							type="education"
							logo="/images/zju.png"
							title="æµ™æ±Ÿå¤§å­¦"
							role="å·¥ä¸šè®¾è®¡ æœ¬ç§‘"
							time="2022 - 2026 (é¢„è®¡)"
						/>
					</div>
				</div>
			</div>
		</div>
	</section>

	<script>
		const toggleBtn = document.getElementById('lang-toggle');
		const contentEn = document.getElementById('content-en');
		const contentZh = document.getElementById('content-zh');

		// Check local storage
		const currentLang = localStorage.getItem('lang') || 'en';
		if (currentLang === 'zh') {
			contentEn?.classList.add('hidden');
			contentZh?.classList.remove('hidden');
		}

		toggleBtn?.addEventListener('click', () => {
			if (contentEn?.classList.contains('hidden')) {
				// Switch to EN
				contentEn.classList.remove('hidden');
				contentZh?.classList.add('hidden');
				localStorage.setItem('lang', 'en');
			} else {
				// Switch to ZH
				contentEn?.classList.add('hidden');
				contentZh?.classList.remove('hidden');
				localStorage.setItem('lang', 'zh');
			}
		});
	</script>

	<!-- Posts Section -->
	<section aria-label="Blog post list" class="'mt-[-100vh] pt-[100vh]'">
		<h2 class="title mb-6 text-xl text-accent-two">
			<a href="/posts/">Posts</a>
		</h2>
		<ul class="space-y-4 md:space-y-2" role="list">
			{
				allPostsByDate.map((p) => (
					<li class="gap-2 sm:grid-cols-[auto_1fr]">
						<PostPreview post={p} />
					</li>
				))
			}
		</ul>
	</section>

	<!-- Notes Section -->
	{
		latestNotes.length > 0 && (
			<section class="mt-12">
				<h2 class="title mb-6 text-accent-two">
					<a href="/notes/">Notes</a>
				</h2>
				<div class="grid grid-cols-1 gap-8 sm:grid-cols-2">
					{
						latestNotes.map((note) => (
							<div>
								<Note note={note} as="h4" isPreview />
							</div>
						))
					}
				</div>
			</section>
		)
	}
</PageLayout>
