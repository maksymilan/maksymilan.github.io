---
import PageLayout from "@/layouts/Base.astro";
import { friends } from "@/data/friend";

const meta = {
	description: "友情链接",
	title: "Links",
};
---

<PageLayout meta={meta}>
	<h1 class="title mb-6">友情链接</h1>
	<div class="prose prose-citrus max-w-none mb-10">
		<p>
        欢迎交换友链～
		</p>
	</div>
	
	<div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
		{friends.map((friend) => (
			<a 
				href={friend.url} 
				target="_blank" 
				rel="noopener noreferrer"
				class="group flex items-center p-4 rounded-lg bg-gray-50 dark:bg-gray-800 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200 border border-transparent hover:border-accent-base/50"
			>
				{friend.avatar && (
					<img 
						src={friend.avatar} 
						alt={friend.name} 
						class="w-16 h-16 rounded-full mr-4 object-cover border border-gray-200 dark:border-gray-700"
						loading="lazy"
					/>
				)}
				<div class="flex-1 min-w-0">
					<h2 class="text-lg font-bold group-hover:text-accent-base transition-colors truncate">{friend.name}</h2>
					<p class="text-sm text-gray-600 dark:text-gray-400 line-clamp-2">{friend.description}</p>
				</div>
			</a>
		))}
	</div>
	{friends.length === 0 && (
		<p class="text-gray-500 italic">暂无友情链接，欢迎互换！</p>
	)}

	<div class="prose prose-citrus max-w-none mt-10 mb-10">
		<h3>本站信息</h3>
		<p>本站信息如下（点击快速复制）：</p>
		<pre class="relative"><code>Name: Maksymilan's
Desc: Connecting the dots.
Link: https://maksymilan.github.io/
Avatar: https://github.com/maksymilan.png</code></pre>
	</div>
</PageLayout>

<!-- Copy code button -->
<script>
	// Wait for the content to fully load
	document.addEventListener("DOMContentLoaded", () => {
		// Find all pre blocks
		document.querySelectorAll("pre").forEach((pre) => {
			// Check if the button already exists
			if (!pre.querySelector(".copy-code")) {
				// Create the button
				const copyButton = document.createElement("button");
				copyButton.className =
				"absolute flex items-center justify-center bg-bgColor h-6 font-medium overflow-hidden rounded-md text-light hover:text-accent-two font-sans text-sm font-medium top-2 right-2";

				// Create the span element that will hold the button text
				const buttonText = document.createElement("span");
				buttonText.innerText = "Copy"; // Initial text
				buttonText.className = "flex items-center block w-full h-full px-2 bg-[var(--code-title-bg)]"; // Set the span to take up full width with background color

				copyButton.appendChild(buttonText); // Append span to the button

				// Add the button inside pre
				pre.appendChild(copyButton);

				// Event handler for copying text
				copyButton.addEventListener("click", async () => {
					const code = pre.querySelector("code")?.textContent;
					if (code) {
						await navigator.clipboard.writeText(code);
						buttonText.innerText = "Copied!"; // Change text to "Copied!"

						// After 1.5 seconds, change the text back to "Copy"
						setTimeout(() => {
							buttonText.innerText = "Copy";
						}, 1500);
					}
				});
			}
		});
	});
</script>
